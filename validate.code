import "utils/pack/pack128.code" as pack128
import "utils/pack/unpack128.code" as unpack128
import "hashes/sha256/1024bit.code" as sha256for1024
import "./sha256only.code" as sha256only

def main(field[5] preimage) -> (field[2]):

	a = unpack128(preimage[0])
	b = unpack128(preimage[1])
	c = unpack128(preimage[2])
	d = unpack128(preimage[3])
	e = unpack128(preimage[4])

	field[256] preimage1 = [...a, ...b]
	field[256] preimage2 = [...c, ...d]
	field[256] preimage3 = [...[...e, 1], ...[0; 127]]
	field[256] dummy = [...[0; 246], ...[1, 0, 1, 0, 0, 0, 0, 0, 0, 0]] //second array indicates length of preimage = 640bit

	intermediary = sha256for1024(preimage1, preimage2, preimage3, dummy)

    r = sha256only(intermediary)

	res0 = pack128(r[0..128])

    res1 = pack128(r[128..256])

return [res0, res1]
